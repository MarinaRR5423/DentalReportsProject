{% extends "dental_reports/base.html" %}

{% block title %}Inicio | {{ block.super }}{% endblock %}

{% block extra_css %}
<style>
    .feature-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        color: #0d6efd;
    }

    .stats-card {
        transition: transform 0.3s ease;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        border-radius: 0.5rem;
        overflow: hidden;
        height: 100%;
    }

    .stats-card:hover {
        transform: translateY(-5px);
    }

    .stats-number {
        font-size: 2.5rem;
        font-weight: bold;
        color: #0d6efd;
    }

    .welcome-section {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 3rem 0;
        border-radius: 0.5rem;
        margin-bottom: 2rem;
    }

    .recent-section {
        margin-top: 3rem;
    }

    .action-button {
        border-radius: 50px;
        padding: 0.5rem 1.5rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
        transition: all 0.3s;
    }

    .action-button:hover {
        transform: translateY(-1px);
        box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08);
    }

    .card-header-custom {
        background-color: #f8f9fa;
        border-bottom: none;
        padding-bottom: 0;
    }

    .list-group-item-action {
        transition: all 0.2s;
    }

    .list-group-item-action:hover {
        background-color: #f8f9fa;
        transform: translateX(5px);
    }
</style>
{% endblock %}

{% block content %}
<!-- Welcome Section -->
<div class="welcome-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-7">
                <h1 class="display-4 mb-4">Sistema de Informes Dentales</h1>
                <p class="lead mb-4">Crea, personaliza y gestiona informes dentales profesionales de forma rápida y sencilla</p>
                <div class="d-flex gap-2">
                    <a href="{% url 'template_list' %}" class="btn btn-primary action-button">
                        <i class="fas fa-file-medical me-2"></i>Ver Plantillas
                    </a>
                    <a href="{% url 'template_create' %}" class="btn btn-success action-button">
                        <i class="fas fa-plus me-2"></i>Crear Nueva
                    </a>
                </div>
            </div>
            <div class="col-md-5 text-center">
                <img src="https://placehold.co/600x400?text=Dental+Reports" class="img-fluid rounded shadow" alt="Informes Dentales">
            </div>
        </div>
    </div>
</div>

<!-- Stats Section -->
<div class="row mb-4">
    <div class="col-md-3 mb-4">
        <div class="stats-card card text-center">
            <div class="card-body">
                <div class="feature-icon">
                    <i class="fas fa-file-medical"></i>
                </div>
                <div class="stats-number">{{ templates_count|default:"0" }}</div>
                <h5 class="card-title">Plantillas</h5>
                <a href="{% url 'template_list' %}" class="stretched-link"></a>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-4">
        <div class="stats-card card text-center">
            <div class="card-body">
                <div class="feature-icon">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <div class="stats-number">{{ reports_count|default:"0" }}</div>
                <h5 class="card-title">Informes</h5>
                <a href="{% url 'report_list' %}" class="stretched-link"></a>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-4">
        <div class="stats-card card text-center">
            <div class="card-body">
                <div class="feature-icon">
                    <i class="fas fa-hospital"></i>
                </div>
                <div class="stats-number">{{ clinics_count|default:"0" }}</div>
                <h5 class="card-title">Clínicas</h5>
                <a href="{% url 'clinic_list' %}" class="stretched-link"></a>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-4">
        <div class="stats-card card text-center">
            <div class="card-body">
                <div class="feature-icon">
                    <i class="fas fa-user-md"></i>
                </div>
                <div class="stats-number">{{ dentists_count|default:"0" }}</div>
                <h5 class="card-title">Dentistas</h5>
                <a href="{% url 'dentist_list' %}" class="stretched-link"></a>
            </div>
        </div>
    </div>
</div>

<!-- Features Section -->
<div class="row my-5">
    <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm">
            <div class="card-body text-center">
                <div class="feature-icon">
                    <i class="fas fa-edit"></i>
                </div>
                <h5 class="card-title">Plantillas Personalizables</h5>
                <p class="card-text">Crea y gestiona plantillas para diferentes tipos de informes dentales según tus necesidades.</p>
                <a href="{% url 'template_create' %}" class="btn btn-outline-primary">Crear plantilla</a>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm">
            <div class="card-body text-center">
                <div class="feature-icon">
                    <i class="fas fa-file-export"></i>
                </div>
                <h5 class="card-title">Exportación a PDF</h5>
                <p class="card-text">Genera informes profesionales en formato PDF listos para compartir con pacientes y colegas.</p>
                <a href="{% url 'report_list' %}" class="btn btn-outline-primary">Ver informes</a>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm">
            <div class="card-body text-center">
                <div class="feature-icon">
                    <i class="fas fa-address-book"></i>
                </div>
                <h5 class="card-title">Gestión de Contactos</h5>
                <p class="card-text">Mantén organizada tu red de clínicas y dentistas para compartir informes fácilmente.</p>
                <a href="{% url 'dentist_list' %}" class="btn btn-outline-primary">Ver contactos</a>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity Section -->
<div class="recent-section">
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header card-header-custom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-file-medical me-2"></i>Plantillas Recientes
                        </h5>
                        <a href="{% url 'template_list' %}" class="btn btn-sm btn-outline-primary">Ver todas</a>
                    </div>
                </div>
                <div class="card-body">
                    {% if recent_templates %}
                        <div class="list-group list-group-flush">
                            {% for template in recent_templates %}
                            <a href="{% url 'template_detail' pk=template.id %}" class="list-group-item list-group-item-action border-0 py-3">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">{{ template.name }}</h6>
                                    <small class="text-muted">{{ template.created_at|date:"d/m/Y" }}</small>
                                </div>
                                <p class="mb-1 text-truncate">{{ template.description|default:"Sin descripción" }}</p>
                                <small class="text-primary">{{ template.category.name|default:"Sin categoría" }}</small>
                            </a>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-file-medical fa-3x text-muted mb-3"></i>
                            <p class="mb-0">No hay plantillas disponibles</p>
                            <a href="{% url 'template_create' %}" class="btn btn-sm btn-primary mt-3">
                                Crear primera plantilla
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header card-header-custom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-file-pdf me-2"></i>Informes Recientes
                        </h5>
                        <a href="{% url 'report_list' %}" class="btn btn-sm btn-outline-primary">Ver todos</a>
                    </div>
                </div>
                <div class="card-body">
                    {% if recent_reports %}
                        <div class="list-group list-group-flush">
                            {% for report in recent_reports %}
                            <a href="{% url 'report_detail' pk=report.id %}" class="list-group-item list-group-item-action border-0 py-3">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">{{ report.title }}</h6>
                                    <small class="text-muted">{{ report.created_at|date:"d/m/Y" }}</small>
                                </div>
                                <p class="mb-1">Paciente: {{ report.patient_name }}</p>
                                <small class="text-success">{{ report.template.name|default:"Sin plantilla" }}</small>
                            </a>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-file-pdf fa-3x text-muted mb-3"></i>
                            <p class="mb-0">No hay informes generados</p>
                            <a href="{% url 'template_list' %}" class="btn btn-sm btn-primary mt-3">
                                Generar primer informe
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Animación de contadores para las estadísticas
    document.addEventListener('DOMContentLoaded', () => {
        const statElements = document.querySelectorAll('.stats-number');

        statElements.forEach(element => {
            const targetValue = parseInt(element.textContent);
            if (!isNaN(targetValue)) {
                let currentValue = 0;
                const duration = 1500; // 1.5 segundos
                const increment = Math.ceil(targetValue / (duration / 16)); // aproximadamente 60 fps

                const counter = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= targetValue) {
                        element.textContent = targetValue;
                        clearInterval(counter);
                    } else {
                        element.textContent = currentValue;
                    }
                }, 16);
            }
        });
    });
</script>
{% endblock %}
